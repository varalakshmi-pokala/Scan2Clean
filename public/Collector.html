<!DOCTYPE html>
<html>
<head>
    <title>Scan2Clean Collector Dashboard</title>

    <style>
        body{
            font-family: Arial;
            padding:20px;
        }

        table{
            width:100%;
            border-collapse: collapse;
        }

        th, td{
            border:1px solid #ccc;
            padding:10px;
            text-align:center;
        }

        img{
            width:80px;
            height:80px;
            object-fit:cover;
            border-radius:6px;
        }

        button{
            padding:5px 10px;
            background:#28a745;
            color:white;
            border:none;
            cursor:pointer;
        }
    </style>
</head>

<body>

<h2>â™» Scan2Clean Collector Dashboard</h2>

<table id="table"></table>

<script>

async function loadData(){

    const res = await fetch("http://localhost:5000/requests");
    const data = await res.json();

    let html = `
    <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Phone</th>
        <th>Description</th>
        <th>Date</th>
        <th>Location</th>
        <th>Status</th>
        <th>Action</th>
    </tr>
    `;

    data.forEach(r => {

        const imgUrl = `http://localhost:5000/uploads/${r.image}`;

        html += `
        <tr>
            <td><img src="${imgUrl}" /></td>
            <td>${r.name}</td>
            <td>${r.phone}</td>
            <td>${r.description}</td>
            <td>${r.date}</td>
            <td>${r.location}</td>
            <td>${r.status}</td>
            <td>
                <button onclick="updateStatus('${r._id}')">Complete</button>
            </td>
        </tr>
        `;
    });

    document.getElementById("table").innerHTML = html;
}

async function updateStatus(id){
    await fetch("http://localhost:5000/update/"+id,{
        method:"PUT",
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({status:"Completed"})
    });

    loadData();
}

loadData();

</script>

</body>
</html>
